#includepath "~/Documents/;%USERPROFILE%Documents";#include "basiljs/bundle/basil.js";var autori = [];var anno = [];var titolo = [];var editore = [];var luogo = [];var cols, rows;var cellWidth, cellHeight;var tokens = ",";var string = "";var s = 1;var index = 0;function setup(){	    b.clear(b.page()); // cancella gli elementi presenti sulla pagina    b.canvasMode(b.MARGIN);    b.units(b.MM);			b.textFont("SF Pro Display", "Medium");	b.textAlign(Justification.LEFT_ALIGN);		b.textLeading(Leading.AUTO);	b.textSize(7);		// Carica file CSV (Deve essere presente nella cartella del file inDesign	var data = b.CSV.decode( b.loadString("Bibliografia.csv") );	b.println("loaded "+data.length+" bibliografie");	// Colonne e righe	var colonne = 4;	var righe = 15;		// Margine tra le celle	var margine = 1;		larghezzaCella = b.width / colonne;	altezzaCella = b.height / righe;	// Analizza i dati del file CSV	for (var i = 0; i < data.length; i++) {		data[i].anno = parseInt(data[i].anno);		anno.push(data[i].anno+ "\n");		autori.push(data[i].autore +"\n");		titolo.push(data[i].titolo+ "\n");		editore.push(data[i].editore+ ": ");		luogo.push(data[i].luogo + "\n");	}		for(var i = 0; i < colonne; i++){						for(var j = 0; j < righe; j++){									var x = i * larghezzaCella;		var y = j * altezzaCella;				b.fill(0);		b.noStroke();		string += autori[index] ;			string += titolo[index] ;		string += editore[index];		string += luogo[index];		string += anno[index] ;						b.text(string,x, y, larghezzaCella-margine*2, altezzaCella-margine*2);				string = "";		index++;				if ( index == data.length) return;				}	}}b.go();